;/*FB_PKG_DELIM*/

__d("VideoPlayerIMFStickersOverlayRelayQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="5859315677517462"}),null);
__d("VideoPlayerIMFStickersOverlayRelayQuery.graphql",["VideoPlayerIMFStickersOverlayRelayQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"scale"},{defaultValue:null,kind:"LocalArgument",name:"stickerRequests"},{defaultValue:null,kind:"LocalArgument",name:"videoId"}],c=[{kind:"Variable",name:"id",variableName:"videoId"}],d=[{kind:"Variable",name:"sticker_requests",variableName:"stickerRequests"}],e=[{kind:"Literal",name:"supported",value:["XFBVideoCometIMFFollowStickerRenderer","XFBVideoCometIMFCommentHighlightStickerRenderer"]}],f={kind:"InlineFragment",selections:[{args:null,documentName:"VideoPlayerIMFStickersOverlayRelayQuery",fragmentName:"VideoPlayerIMFFollowSticker_sticker_renderer",fragmentPropName:"sticker_renderer",kind:"ModuleImport"}],type:"XFBVideoCometIMFFollowStickerRenderer",abstractKey:null},g={kind:"InlineFragment",selections:[{args:null,documentName:"VideoPlayerIMFStickersOverlayRelayQuery",fragmentName:"VideoPlayerIMFCommentHighlightSticker_sticker_renderer",fragmentPropName:"sticker_renderer",kind:"ModuleImport"}],type:"XFBVideoCometIMFCommentHighlightStickerRenderer",abstractKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VideoPlayerIMFStickersOverlayRelayQuery",selections:[{alias:null,args:c,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[{alias:null,args:d,concreteType:"XFBVideoCometIMFSticker",kind:"LinkedField",name:"comet_imf_stickers",plural:!0,selections:[{alias:null,args:e,concreteType:null,kind:"LinkedField",name:"sticker_renderer",plural:!1,selections:[f,g],storageKey:'sticker_renderer(supported:["XFBVideoCometIMFFollowStickerRenderer","XFBVideoCometIMFCommentHighlightStickerRenderer"])'}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VideoPlayerIMFStickersOverlayRelayQuery",selections:[{alias:null,args:c,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[{alias:null,args:d,concreteType:"XFBVideoCometIMFSticker",kind:"LinkedField",name:"comet_imf_stickers",plural:!0,selections:[{alias:null,args:e,concreteType:null,kind:"LinkedField",name:"sticker_renderer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},f,g],storageKey:'sticker_renderer(supported:["XFBVideoCometIMFFollowStickerRenderer","XFBVideoCometIMFCommentHighlightStickerRenderer"])'}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:b("VideoPlayerIMFStickersOverlayRelayQuery_facebookRelayOperation"),metadata:{},name:"VideoPlayerIMFStickersOverlayRelayQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("VideoPlayerIMFModuleLazy",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";var h=c("JSResourceForInteraction")("VideoPlayerIMFModuleForLazyLoading").__setRef("VideoPlayerIMFModuleLazy"),i=null;a={getModuleIfRequireable:function(){return h.getModuleIfRequireable()},load:function(){i==null&&(i=h.load());return i}};b=a;g["default"]=b}),98);
__d("VideoPlayerIMFStateContainer",["ErrorMetadata","ErrorSerializer","FBLogger","VideoPlayerEmsg","VideoPlayerHooks","VideoPlayerIMFMetadataContext","VideoPlayerIMFModuleLazy","deepEquals","err","getErrorSafe","promiseDone","react","useVideoPlayerControllerSubscription"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useDebugValue,i=b.useEffect,j=b.useRef,k=b.useState;function l(a,b,c){a.forEach(function(a){a.segments.forEach(function(d){var e=d.playheadRangeInSeconds,f=d.sticker;f!=null&&(e.from==null||e.from<=b)&&(e.to==null||b<=e.to)&&c.push({debugInfo:{segmentData:d.segmentData,trackData:a.trackData,trackName:a.trackName},sticker:f})})})}function m(a,b,c,d){l(a.tracks,b,d)}function n(a,b){return{debug_reason:null,error_user_info:JSON.stringify({emsgDataStr:b.emsgDataStr,emsgDurationInSec:b.emsgDurationInSec,emsgId:b.emsgId,emsgScheme:b.emsgScheme,emsgStartTimeInSec:b.emsgStartTimeInSec}),imf_emsg_id:b.emsgId!=null?String(b.emsgId):null,imf_topic:b.emsgScheme,offset_ms:b.emsgStartTimeInSec==null?null:a*1e3-b.emsgStartTimeInSec*1e3,representation_id:b.representationID}}function o(a,b,d,e,f,g,h){a=a.map(function(a){return a.type==="imf_live_sticker"?a:null}).filter(Boolean);var i=a[a.length-1];if(i!=null)try{e=e.parseVideoPlayerIMFSpecFromIMFLiveStickerEmsgBox(i);l(e.tracks,b,g)}catch(l){var j=c("getErrorSafe")(l);e=j.metadata||new(c("ErrorMetadata"))();d!=null&&e.addEntry("COMET_VIDEO","VIDEO_ID",d);e.addEntry("COMET_VIDEO","VIDEO_IMPLEMENTATION_DEBUG_DATA",JSON.stringify({imf_live_sticker_emsg_boxes:a}));var k=j.errorName!=null&&j.errorName!==""?j.errorName:j.name,m=j.messageFormat!=null?j.messageFormat:j.message,o=(j.messageFormat!=null?(g=j.messageParams)!=null?g:[]:[]).slice(),p="CometVideoPlayerEmsgParseFailed",q=p+":"+(j.errorName!=null&&j.errorName!==""?j.errorName:j.name),r=c("ErrorSerializer").toReadableMessage(c("err").apply(void 0,[m].concat(o)));h.push(function(){var a;(a=c("FBLogger")("comet_video_player").catching(j)).warn.apply(a,["CometVideoPlayerIMFLiveStickerParseFailed:"+k+": "+m].concat(o))});h.push(function(){f==null?void 0:f(babelHelpers["extends"]({},n(b,i),{error:q,error_code:"0",error_description:r,error_domain:p,error_type:"GenericParseError",imf_event_type:"IMF_JSON_PARSE_FAILURE"}))})}}function p(a){var b=a.VideoPlayerIMFModuleLoaded,e=a.specInlineJson,f=a.videoID;return function(a,g){var h=a.getPlayheadPosition(),i=a.getCurrentState(),j=i.activeEmsgBoxes;if(g!=null&&h===g.playhead&&j===g.activeEmsgBoxes&&e===g.specInlineJson)return g;i=[];var k=[],l=e==null?null:g!=null&&e===g.specInlineJson?g.specFromVideoMetadata:function(){var a;a=(a=b)!=null?a:c("VideoPlayerIMFModuleLazy").getModuleIfRequireable();if(a!=null)try{return a.parseVideoPlayerIMFSpecFromVODInlineJSON(e)}catch(a){k.push(function(){var b=c("FBLogger")("comet_video_player");f!=null&&b.addMetadata("COMET_VIDEO","VIDEO_ID",f);b.addMetadata("COMET_VIDEO","VIDEO_IMPLEMENTATION_DEBUG_DATA",JSON.stringify({imf_spec_inline_json:e}));b.catching(a);b.mustfix("Failed to parse IMF Inline JSON.")});return null}}();l!=null&&m(l,h,f,i);if(j.length>0){var p;p=(p=b)!=null?p:c("VideoPlayerIMFModuleLazy").getModuleIfRequireable();if(p!=null){var q=function(b){a.logVPLEvent_DO_NOT_USE("imf",b)};j!==(g==null?void 0:g.activeEmsgBoxes)&&j.forEach(function(a){a.emsgScheme!=null&&d("VideoPlayerEmsg").KnownEmsgSchemes!=null&&[d("VideoPlayerEmsg").KnownEmsgSchemes.LIVE_INSTREAM_ADS_SCHEME_ID,d("VideoPlayerEmsg").KnownEmsgSchemes.LIVE_STICKER_SCHEME_ID,d("VideoPlayerEmsg").KnownEmsgSchemes.LIVE_INTERACTIVE_PLUGIN_EVENT_ID].includes(a.emsgScheme)&&k.push(function(){q==null?void 0:q(babelHelpers["extends"]({},n(h,a),{imf_event_type:"IMF_RENDER"}))})});o(j,h,f,p,q,i,k)}else k.push(function(){var a=c("FBLogger")("comet_video_player");f!=null&&a.addMetadata("COMET_VIDEO","VIDEO_ID",f);a.addMetadata("COMET_VIDEO","VIDEO_IMPLEMENTATION_DEBUG_DATA",JSON.stringify({active_emsg_boxes:j}));a.warn("VideoPlayerIMFModule is not available to parse active emsg boxes.")})}p={stickers:i};return g!=null&&c("deepEquals")(p,g.exposedState)?g:{activeEmsgBoxes:j,exposedState:p,playhead:h,sideEffects:k,specFromVideoMetadata:l,specInlineJson:e}}}function q(a){var b=k(a),c=b[0];b=b[1];c===!1&&a===!0&&b(!0);return c}function r(a){var b;a=a.videoPlayerIMFFromVideoMetadata;var e=q((b=a==null?void 0:a.imfExpectedFromEmsg)!=null?b:!1),f=a==null?void 0:a.specInlineJson;d("VideoPlayerHooks").useEmsgObserver(e);b=k(c("VideoPlayerIMFModuleLazy").getModuleIfRequireable());var g=b[0],l=b[1],m=j(null);i(function(){if(g==null&&m.current==null&&(e||f!=null)){var a=c("VideoPlayerIMFModuleLazy").load().then(function(b){if(m.current!==a)return;l(b)});c("promiseDone")(a);m.current=a;return function(){m.current=null}}},[g,e,f]);a=d("VideoPlayerHooks").useVideoFbid();var n=c("useVideoPlayerControllerSubscription")(p({VideoPlayerIMFModuleLoaded:g,specInlineJson:f,videoID:a}));h({useVideoPlayerIMFStateContainer:n});var o=j(null);i(function(){var a=n.sideEffects;a!==o.current&&(o.current=a,a.forEach(function(a){a()}))});return n}function a(){var a=d("VideoPlayerIMFMetadataContext").useVideoPlayerIMFMetadataFromContext();a=r({videoPlayerIMFFromVideoMetadata:a});return(a=a.exposedState)!=null?a:null}g.makeVideoPlayerIMFInternalStateUpdater=p;g.useVideoPlayerIMFStateContainerInternal=r;g.useVideoPlayerIMFStateContainer=a}),98);
__d("VideoPlayerIMFStickerErrors",["ErrorMetadata"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d){var e=new(c("ErrorMetadata"))();d!=null&&e.addEntry("COMET_VIDEO","VIDEO_ID",d);return{errorName:a,messageFormat:b+' in video "%s"',messageParams:[String(d)],metadata:e,project:"comet_video_player"}}function b(a,b,d,e){var f=new(c("ErrorMetadata"))();d!=null&&f.addEntry("COMET_VIDEO","VIDEO_ID",d);f.addEntry("COMET_VIDEO","VIDEO_IMPLEMENTATION_DEBUG_DATA",JSON.stringify({imf_sticker_id:e.sticker.stickerId,imf_sticker_type:e.sticker.stickerType}));return{errorName:a,messageFormat:b+' with sticker "%s":"%s" in video "%s"',messageParams:[e.sticker.stickerType,e.sticker.stickerId,String(d)],metadata:f,project:"comet_video_player"}}g.makeVideoPlayerIMFAllStickersErrorContext=a;g.makeVideoPlayerIMFSingleStickerErrorContext=b}),98);
__d("useVideoPlayerIMFStickerTransform",["VideoPlayerHooks","react"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useDebugValue,i=b.useMemo;function j(a){return(100*a).toFixed(5)+"%"}function k(a){var b=a.containerAspectRatio,c=a.transform,d=a.videoPixelsAspectRatio;a=a.videoPixelsFit;a=a!=null&&a.objectFit==="cover";var e=1,f=e/b,g=1,h=g*b;a=a?d>=b:b>=d;b=a?f:e;f=a?g:h/d;h=a?b*d:e;b=a?(e-h)/2:0;d=a?0:(g-f)/2;e=c.relativeX*h;a=c.relativeY*f;g=c.relativeWidth*h;h=c.relativeHeight*f;f=b+e;b=d+a;e=g;d=h;a=c.rotationDegrees;return{relativeHeight:d,relativeWidth:e,relativeX:f,relativeY:b,rotationDegrees:a}}function l(a,b){if(a==null||b==null)return{cssStyle:{display:"none"},stickerAspectRatio:null,stickerBox:null};var c=a.relativeHeight,d=a.relativeWidth,e=a.relativeX,f=a.relativeY;a=a.rotationDegrees;c={height:c*b.height,width:d*b.width};d=c.width/Math.max(c.height,1);b={boxSizing:"border-box",height:c.height*1.01,left:j(e),position:"absolute",top:j(f),transform:"rotate("+a.toFixed(5)+"deg)",transformOrigin:"50% 50%",width:c.width*1.005};return{cssStyle:b,stickerAspectRatio:d,stickerBox:c}}function a(a){a=a.stickerState;var b=d("VideoPlayerHooks").useDimensions(),c=b!=null?b.width/Math.max(b.height,1):null,e=d("VideoPlayerHooks").useVideoPixelsAspectRatio(),f=d("VideoPlayerHooks").useVideoPlayerVideoPixelsFit(),g=a.sticker.stickerTransform;a=i(function(){var a=c==null||e==null?null:k({containerAspectRatio:c,transform:g,videoPixelsAspectRatio:e,videoPixelsFit:f}),d=l(a,b),h=d.cssStyle,i=d.stickerAspectRatio;d=d.stickerBox;return{containerAspectRatio:c,containerBox:b,cssStyle:h,stickerAspectRatio:i,stickerBox:d,transformNumbers:a,videoPixelsAspectRatio:(h=e)!=null?h:null}},[b,c,e,f,g]);h({containerAspectRatio:c,ret:a,transform:g,videoPixelsAspectRatio:e});return a}g.computeVideoPlayerIMFStickerTransformNumbers=k;g.computeVideoPlayerIMFStickerTransformCSSStyle=l;g.useVideoPlayerIMFStickerTransform=a}),98);
__d("VideoPlayerIMFStickerPressable.react",["CometPressable.react","react","requireDeferred","useSinglePartialViewImpression","useVideoPlayerIMFStickerTransform"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=c("requireDeferred")("LiveVideoOverlayStickerFalcoEvent").__setRef("VideoPlayerIMFStickerPressable.react");function a(a){var b=a.children,e=a.disabled,f=a.loggingInfo,g=a.onHoverChange,j=a.onPress,k=a.onPressChange,l=a.stickerState,m=a.style,n=a.xstyle;a=babelHelpers.objectWithoutPropertiesLoose(a,["children","disabled","loggingInfo","onHoverChange","onPress","onPressChange","stickerState","style","xstyle"]);var o=d("useVideoPlayerIMFStickerTransform").useVideoPlayerIMFStickerTransform({stickerState:l});o=o.cssStyle;var p=c("useSinglePartialViewImpression")({onImpressionStart:function(){i.onReady(function(a){a.log(function(){var a;return{event:"viewer_impression",overlay_id:l.sticker.stickerId,overlay_sub_type:(a=f.stickerSubtype)!=null?a:"Default",overlay_type:l.sticker.stickerType}})})}}),q=function(a){j&&j(a),i.onReady(function(a){a.log(function(){var a;return{event:"viewer_tap",overlay_id:l.sticker.stickerId,overlay_sub_type:(a=f.stickerSubtype)!=null?a:"Default",overlay_type:l.sticker.stickerType}})})};return h.jsx(c("CometPressable.react"),babelHelpers["extends"]({},a,{disabled:e===!0,expanding:!1,onHoverChange:g,onPress:q,onPressChange:k,overlayDisabled:!0,overlayRadius:0,ref:p,style:babelHelpers["extends"]({},m,o),xstyle:n,children:b}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerIMFStickerPlaceholderForError.react",["fbt","VideoPlayerIMFStickerPressable.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(a){a=a.stickerState;return i.jsx(c("VideoPlayerIMFStickerPressable.react"),{"aria-label":h._("__JHASH__K5eaGC7NX0i__JHASH__"),loggingInfo:{},onPress:function(){},stickerState:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerIMFStickerPlaceholderForSuspense.react",["fbt","VideoPlayerIMFStickerPressable.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(a){a=a.stickerState;return i.jsx(c("VideoPlayerIMFStickerPressable.react"),{"aria-label":h._("__JHASH__6lD-XyRyuHe__JHASH__"),loggingInfo:{},onPress:function(){},stickerState:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerIMFStickersOverlayRelay.react",["CometErrorBoundary.react","CometPlaceholder.react","CometRelay","VideoPlayerHooks","VideoPlayerIMFStateContainer","VideoPlayerIMFStickerErrors","VideoPlayerIMFStickerPlaceholderForError.react","VideoPlayerIMFStickerPlaceholderForSuspense.react","VideoPlayerIMFStickersOverlayRelayQuery.graphql","WebPixelRatio","err","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react"),j=d("react").useMemo;function k(a){var e=a.stickerState,f=a.videoId;a=j(function(){var a;return{scale:d("WebPixelRatio").get(),stickerRequests:[{sticker_id:e.sticker.stickerId,sticker_type:e.sticker.stickerType}],videoId:(a=f)!=null?a:""}},[e.sticker.stickerId,e.sticker.stickerType,f]);a=d("CometRelay").useLazyLoadQuery(h!==void 0?h:h=b("VideoPlayerIMFStickersOverlayRelayQuery.graphql"),a,{fetchKey:e.sticker.stickerId,fetchPolicy:"store-or-network"});if(f==null)throw c("err")("Video ID is missing");if(a.video==null)throw c("err")("Video data is missing");a=a.video.comet_imf_stickers[0];if(a==null)throw c("err")("Sticker data is missing");a=a.sticker_renderer;if(a==null)throw c("err")("Sticker renderer is missing");return i.jsx(d("CometRelay").MatchContainer,{fallback:null,match:a,props:{stickerRenderer$key:a,stickerState:e,videoId:f}})}k.displayName=k.name+" [from "+f.id+"]";function l(){var a=d("VideoPlayerHooks").useVideoFbid(),b=d("VideoPlayerIMFStateContainer").useVideoPlayerIMFStateContainer();return i.jsx(i.Fragment,{children:b==null?void 0:b.stickers.map(function(b){return i.jsx(c("CometErrorBoundary.react"),{context:d("VideoPlayerIMFStickerErrors").makeVideoPlayerIMFSingleStickerErrorContext("VideoPlayerIMFStickerFailedToRender","Failed to render sticker",a,b),fallback:function(a){return i.jsx(c("VideoPlayerIMFStickerPlaceholderForError.react"),{error:a,stickerState:b})},onError:function(a){},children:i.jsx(c("CometPlaceholder.react"),{fallback:i.jsx(c("VideoPlayerIMFStickerPlaceholderForSuspense.react"),{stickerState:b}),children:i.jsx(k,{stickerState:b,videoId:a},b.sticker.stickerId)})},b.sticker.stickerId)})})}l.displayName=l.name+" [from "+f.id+"]";function a(){var a=d("VideoPlayerHooks").useVideoFbid();return i.jsx(c("CometErrorBoundary.react"),{context:d("VideoPlayerIMFStickerErrors").makeVideoPlayerIMFAllStickersErrorContext("VideoPlayerIMFStickersOverlayRelayFailedToRender","Failed to render all stickers",a),fallback:function(){return null},onError:function(){},children:i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(l,{})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);